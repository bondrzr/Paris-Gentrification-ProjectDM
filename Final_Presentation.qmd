---
title: "Paris Gentrification Presentation"
author: "Paul Joahny and Matei Vasile"
format: pdf
---
```{r}
#| echo: false
#| message: false
#| warning: false
library(here)
library(dplyr)
library(ggplot2)
```
```{r}
#| echo: false
#| message: false
#| warning: false
index_rev <- readRDS(here("DATA_processed", "index_rev.rds"))
iris_overall <- readRDS(here("DATA_processed", "iris_overall.rds"))
```


# 1. Research Question

This report attempts to answer the question \textbf{how does gentrification in the Paris area affect the "Tissu comercial"?} The objective of this report is to assess how the development and structure of businesses changes from gentrified neighbourhoods to those that are not.

Gentrification is a social phenomenon , as many social phenomenon it has different definitions we'll define it as the process by which a poor neighborhood in a city is replaced by a new population. We can evaluate this by looking at the development of the population of a neighbourhood overtime. This is completed via a process in which a poor neighborhood in a city is changed by people who have money, including especially the improvement or replacement of buildings and businesses.

The idea is to see how gentrification can reshape neighbourhoods in terms of retail/service supply. As higher income populations move into formerly lower income or mixed income areas, we expect to observe a shift in the available businesses and more generally the commercial mix: growth of cafes, restaurants, shops, boutiques, coworking spaces etc with a subsequent decrease in traditional proximity retail. We will also attempt to observe whether new types of businesses emerge specifically tailored to a wealthier population.

We will do this by firstly identifying areas (IRIS units) in which clear signs of gentrification have occurred. To do this we will create some indicators for price per sqm, median income levels, poverty rates, income disparity etc. Then using these to identify areas that for example have been previously below the average price per sqm and are now above that, we can note them as gentrified areas.

Once we have identified which IRIS units have undergone gentrification, we will observe changes in the "tissu commerical" of these areas using the BPE (Base Permanente des Equipements). The BPE dataset is a record of the quantity and type of establishments. By analysing changes in the BPE for our identified gentrified areas we can see whether new business categories emerge as the distribution of income changes, which type of businesses increase in quantity, which types decline.

This method of first identifying gentrified areas, then analysing the change in types and quantities of businesses, allows us to observe the effect of gentrification on the "tissu commerical" of Paris. 




# 2. Dataset Descriptions 

a)FILOSOFI

The filosofi database, offers specific estimates of household income, poverty, and inequality at area levels such as IRIS. It combines fiscal data and social benefit data to estimate income before and after redistribution, adjusted per household unit to account for household size and structure. Filosofi replaces older local income datasets and provides useful indicators like income deciles, medians, poverty rates and inequality measures like the Gini coefficient. 

b)IRIS Historical Change

The "Historique des codes IRIS" dataset shows a cross-reference of IRIS codes in France from 1999-2022, revealing how these neighbourhood-level statistical units have changed over time. It offers a "table de passage" that links old and new IRIS identifiers following boundary modifications, splits, or regroupings. This resource allows for researches to align socio-economic data over the years despite changes in IRIS definitions.

c)IRIS Shapefile

The IRIS shapefile provides the official polygon boundaries for all IRIS units in France. The 2020 "France entiere" shapefile offers total coverage of France and is the standard geographic reference for mapping IRIS-level data. It is broadly used to link datasets (like FILOSOFI and DVF) to their corresponding neighbourhoods.

d)DVF

The "Demandes de Valeurs Foncieres" (DVF) dataset, which is available through data.gouv.fr, contains property transaction records for France and includes geographic information when available. We have data sets from 2014-2018 and 2020-2025. DVF provides valuable information such as transaction dates, sale values, property types, surface areas. It can be used to analyse real estate information, such as change in price per square metre. In our project, DVF enables us to construct indicators of housing price changes at the IRIS level.

e)BPE

The "Base Permanente des Equipements" (BPE) dataset for Ile de France. It provides an inventory of public and private facilities, amenities and commercial establishments for the region of France.

f)Activity of residents 

This base « Activité des résidents » gives data on different characteristics of the workers of a given neighborhood. This could be age , sex , CSP category.


# 3. Data Analysis 

The main part of our analysis was finding  a way to measure something you can't directly observe: gentrification. To be able to do that we chose to measure it trough 3 different dimensions. Revenue, Population and Prices.

Population : This whole dimension is looking at who are the people living in said neighbourhoods. In france there's a good indicator called CSP(Catégorie Socio Profesionelle) created and monitored by INSEE this works as a statistical categorisation of jobs of a similar social environment.These categories are 

Employees-Employés : This is Ce groupe socioprofessionnel rassemble des professions aux fonctions très variées (administratives, commerciales, de services aux particuliers, de surveillance et sécurité, etc.) dont il est difficile de trouver une définition commune si ce n'est qu'elles n'ont pas ou peu de responsabilité d'encadrement. Ce groupe socioprofessionnel est composé uniquement de salariés, à de rares exceptions près.


Workers-Ouvriers This represents that work in the industrial secrors 
Ce groupe socioprofessionnel regroupe des personnes qui exercent des fonctions d'exécution dans le cadre d'une division poussée du travail dans les secteurs industriels, de services à l'industrie (nettoyage, maintenance, tri, expédition, etc.) ou des tâches manuelles dans les secteurs artisanaux ou agricoles. Il ne comprend que des salariés, qui peuvent être employés par des établissements de nature publique ou privée.

This is very useful for our analysis some of theses categories represent a 


We chose to measure trough an indicator with a score, gentrification at least as we see it isn't a binary variable it's a relative notion. It makes way more sense to see it as which neighbourhood is more gentrified than an other instead of simply saying which one is or isn't. 
To do this we built an indicator that itself is composed of 3 

Prices: 
Using the DVF dataset, we construct a housing market indicator that measures relative price changes at the IRIS level. The aim of this indicator is to see whether housing prices in a given neighbourhood have increased at a faster rate than the Paris wide market and whether this occurs consistently over time.

First for each IRIS and year, we compute a representative price per square meter using the median values. Next we compute annualised price growth rates between observed years. This expresses the price changes as a per year growth rate, making it possible to compare across different gaps of time. Housing prices are subject to influence from macroeconomic effects and city wide occurrences. To isolate the real changes in price dynamics we compute for each year the Paris wide average growth rate. This benchmark average represents the normal evolution of housing prices in that year. 

Now for each IRIS year we can define relative price growth. Relative price growth is the deviation from the city wide benchmark that we calculated earlier. So for a specific IRIS year a positive deviation would mean price evolution that increased faster than the market, negative meaning prices that lagged behind the market. Then finally, relative price growth rates are accumulated over time to form a final index. This is index is constructed such that the base value 1 represents following the Paris wide price movements exactly, an index greater than 1 would result in cumulative price outperformance and an index less than 1 indicates cumulative underperformance.

```{r}
#| echo: false
#| message: false
#| warning: false

iris_overall %>%
  arrange(desc(index_price)) %>%
  select(CODE_IRIS, index_price) %>%
  slice_head(n=10)

# Density plot alternative (often nicer than histogram)
ggplot(iris_overall,aes(x=index_price))+
  geom_density(fill="darkorange",alpha=0.5)+
  labs(title="Density of Housing Price Index",
       x="Price Index (base = 1)",
       y="Density")+
  theme_minimal()
```


Revenue: 
From the Filosofi dataset we constructed another indicator that captures changes in come structure at the IRIS level. This indicator is composed of two parts: a median income component and a poverty composition component. 

We first look at mdeian income as a measure of economic change that can reveal gentrification. For each IRIS and year, we observe the median income. We compute annualised income growth rates between observed years, this produces a per-year growth rate that we can compare across time. From this we can create for each year a Paris wide average income growth. We define relative income growth as the distance of an IRIS from this city wide average. Positive values indicate that income in an IRIS has grown faster than the Paris average in that year, with negative values showing underperformance comapred to this average. Finally, we aggregated these distances over time into a cumulative relative income index with a base value of 1. An index value of 1 indicates that the median income in the IRIS followed the Paris wide average exactly over the period of time, values over 1 indicate overperformance and those udner 1 indicate underperformance. This accounts for half of the total indicator created from FiloSofi.

```{r}
#| echo: false
#| message: false
#| warning: false
index_rev %>%
  arrange(desc(income_index_score_1)) %>%
  select(iris, income_index_score_1) %>%
  slice_head(n = 10)
```
```{r}
#| echo: false
#| message: false
#| warning: false
ggplot(index_rev, aes(x = income_index_score_1)) +
  geom_histogram(bins = 30, fill = "steelblue", colour = "black") +
  labs(
    title = "Distribution of Income Index",
    x = "Income Index (base = 1)",
    y = "Number of IRIS"
  ) +
  theme_minimal()
```


The second part is constructed from the percentage of the population who have an income deemed under the "poverty line". 

For each IRIS and year, we observe a poverty share P. For each year, all IRIS are ranked by their poverty share thus higher ranks correspond to higher poverty and lower ranks correspond to lower poverty. We then invert the ranking such that higher values indicate lower poverty (improvement). To observe change over time, we compute the change in relative poverty position between the first and last observed years. 

Positive values indicate that an IRIS moved toward the low-poverty end of the Paris wide distribution, while negative values indicate increasing relative poverty. This captures relative displacement or upgrading which can show gentrification.

```{r}
#| echo: false
#| message: false
#| warning: false
index_rev %>%
  arrange(desc(poverty_rank_change)) %>%
  select(iris, poverty_rank_change) %>%
  slice_head(n = 10)

ggplot(index_rev, aes(x = poverty_rank_change)) +
  geom_histogram(
    bins = 30,
    fill = "salmon",
    color = "black"
  ) +
  labs(
    title = "Distribution of Poverty Rank Change",
    x = "Poverty Rank Change",
    y = "Number of IRIS"
  ) +
  theme_minimal()
```


The two indicators constructed from income and poverty capture changes in socioeconomic factors that can unveil gentrification. The income index reflects upwards income change and the poverty rank change reflects changes in the composition of the population. 

Because the two indicators are measured on different scales and have different distributions, each is standardised to have mean zero and unit variance. Thus we create a weighted linear combination concluding with the final index S = 0.6Z(inc) + 0.4Z(pov), a higher S indicates a stronger improvement than average of income changes and poverty share changes relative to Paris wide averages.

```{r}
#| echo: false
#| message: false
#| warning: false
library(ggplot2)
ggplot(index_rev,aes(x=index_rev))+
  geom_histogram(bins=30,fill="darkseagreen3",color="black",alpha=0.85)+
  labs(title="Distribution of Revenue Gentrification Index",
       x="Revenue Index (standardised)",
       y="Number of IRIS")+
  theme_minimal()+
  theme(plot.title=element_text(size=14,face="bold"),
        axis.title=element_text(size=11))
```

Population : 

This indicator was built from the resid_activity databases.The goal of this indicator was to measure how does the population inside a given neighborhood evolves. This is especially interesting for a gentrification perspective to look across time if the composition of a neighborhood has drastically changed ( hint of a wealthier population coming in).

To do so we used 4 databses from 2018 to 2021 which we restricted to the Paris area. Like for the rest of our analysis we needed to harmonize the iris codes to a same Year format and have temporal compatibilty, we kept the IRIS-2020 like for the rest of our previous databases.

The important aspect was now to know which variables to keep further on for our analysis.
Except the ones to help identify (iris , year, ...) we choose to keep :

  -pop1564 <- This represents the total population of the neighbourhood between 15-64.
  
  -act1564  <- This represents the population either working or unemployed ( actively searching for work) of the neighborhood between 15-64.
  
  -actocc1564 <- In act1564 this represents the number people in the neighborhood with  a job.
  
  -chom1564 <- In act1564 this represents the number of unemployed unemployed people in the neighborhood (act1564 = chom1564+ actocc1564)
  
  -sal15p <- this represents the number of residents of the neighborhood that are receiving  a salary ( in contrary to being independent and being your own boss).
  
  -etud1564 <- this represents the number of residents of the neighborhood that are students between the age 15-64. ( They are not considered as actives).
  
  -cadres_1564 <- This represents a sub group of actocc1564, those are residents with a job but more specifically that are executives.
  
  -prof_inter_1564  <- This represents a sub group of actocc1564, those are residents with a job but more specifically that are
  
  -employes_1564  <-   This represents a sub group of actocc1564, those are residents with a job but more specifically that are employees 
  
  -ouvriers_1564 <- This represents a sub group of actocc1564, those are residents with a job but more specifically that are workers ( Closer to manual labor,factory work for example)   

```{r}
#| echo: false
#| message: false
#| warning: false
library(dplyr)
library(knitr)
library(kableExtra)
JOB_all <-readRDS(here("DATA_Processed", "JOB_all.rds"))

JOB_all %>%
head(5) %>%
kable(
caption = "First 5 lines of Merged base",
digits = 2
) %>%
kable_styling(font_size = 7)

```

All of the previously mentioned work can be found in file "Cleaning_resid_actity.qmd" which is found in "Cleaning" file.

After creating this database , it was time to build an indicator. We felt it wasn't very interesting to look at absolute values but more interesting to look at shares of a given CSP( Socio-Professional Category). We made sure our denominator was always bigger than 0 ( Trying to avoid dividing by 0). 

We then created 3 new variables: 

share_csp_sup   = (cadres_1564 + prof_inter_1564) / actocc1564
Csp_sup is a new category we built to look at how more "privileged" or "high-end" professions would be entering the neighborhood. The fact we made it a share reads as the percentage of these high end profile in respect of all workers in the neighborhood. If this share increased this could be seen as more and more of these individuals entering a certain neighborhood, a good lead for gentrification.

 
share_populaire = (employes_1564 + ouvriers_1564) / actocc1564,
Populaire is the opposite side of this analysis. This would be the profile you'd expect to be living in a future gentrified neighborhood and would expect their number to decrease as they are being replaced by CSP_sup. You'd expect that these shares evolve in opposite trends when looking at a potential candidate for gentrification.

share_chom = chom1564 / act1564
This represents the unemployment rate for all active residents. 

After having created these three new variables, we then focused on looking at how these shares evolved over time rather than just their absolute values. To do this, we calculated the slope of each share for each IRIS. To do so we used a linear regression of each share to to find yearly trend. THe goal was to see if the proportion of privileged profession were increasing, if the more popular profession was decreasing and how unemployment was evolving. The goal was to look at dynamic changes since gentrification is a long term process we need some overtime tendancies.

Next, we filtered IRIS with at least 4 years of data to ensure the trends were reliable (available all of our databases timespan 2018-2021). Then, we standardized the slopes (converted them to Z-scores) to put them on the same scale. This step is important because it allows us to combine these different trends into a single indicator without one variable dominating the others simply because of its scale.

Finally, we created a composite population index (index_pop) defined as:

$$
\text{index\_pop} = Z_{CSP+} - Z_{populaire} - Z_{chom}, 
$$

where:

- $Z_{CSP+}$ = standardized slope of high-end professions,  
- $Z_{populaire}$ = standardized slope of popular professions,  
- $Z_{chom}$ = standardized slope of unemployment.

A high score in this index should logically indicate a good neighborhood candidate for gentrification because it should show a certain iris code where the proportion of privileged professions is increasing while the proportion of popular professions and unemployment are decreasing. These tendencies are very consistent with gentrification. On the opposite side a low score should either show a stable neighborhood ( already gentrified or not concerned) or opposite trends which can't be seen as gentrification.

We then sorted IRIS by this index to identify neighborhoods showing the strongest signs of socio-economic change, and saved the results for further analysis.


Final Construction of the GentriScore: (How all were summed)

# 4. Conclusion 
