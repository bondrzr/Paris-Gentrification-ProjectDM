---
title: "DVFcleaning"
author: "Matei Vasile"
format: html
---
```{r}
library(data.table)
library(dplyr)
```

```{r}
file_1418 <- "C:/Users/matei/Desktop/ParisGentrificationDM/Paris-Gentrification-ProjectDM/dvf2014-2018.csv"

IDF_dep <- c("75","77","78","91","92","93","94","95")

dvf_1418 <- fread(file_1418, colClasses = list(character = c("code_departement","code_commune")))

dvf_1418_clean <- dvf_1418 %>%
  filter(code_departement %in% IDF_dep) %>%
  mutate(
    valeur_fonciere    = as.numeric(valeur_fonciere),
    surface_relle_bati = as.numeric(surface_relle_bati),
    prix_m2            = valeur_fonciere / surface_relle_bati
  ) %>%
  filter(
    surface_relle_bati >= 8,
    surface_relle_bati <= 500,
    valeur_fonciere >= 1000,
    valeur_fonciere <= 10000000,
    prix_m2 >= 1000,
    prix_m2 <= 30000
  )
```

```{r}
fwrite(
  dvf_1418_clean,
  "C:/Users/matei/Desktop/ParisGentrificationDM/Paris-Gentrification-ProjectDM/Data/dvf2014_2018_IDF_clean.csv"
)
```

